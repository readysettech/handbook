---
layout: handbook-page-toc
title: "Vulnerability Management"
---

## On this page
{:.no_toc .hidden-md .hidden-lg}

- TOC
{:toc .hidden-md .hidden-lg}

## Scope

The processes laid out here apply to vulnerabilities identified in GitLab the product
or its dependency projects.

## Backlog Review

The application security team will do reviews of the vulnerability backlog to ensure
that it accurately reflects the vulnerabilities present in the product. The frequency of
these reviews will be determined based on compliance requirements or as determined by the
team. The process is intended to determine if open issue are still valid, can be closed,
or are eligible for risk acceptance.

### Roles
- **Appsec Engineers**: The stable counterpart for each development team will be responsible for
reviewing the backlog for their team. For teams with larger backlogs, help will be requested from
other engineers.
- **Appsec Manager(s)**: Responsible for providing support and help make determinations for findings
that need additional input.
- **Director of Security Engineering**: Responsible for making final determination on risk acceptance.

### Labels

Scoped labels will be used to categorize each issue. The labels are as follows:
- `~security-backlog::not-reviewed`
- `~security-backlog::valid`
- `~security-backlog::closed`
- `~security-backlog::reclassified`
- `~security-backlog::risk-acceptance`
- `~security-backlog::needs-input`

### Issues in Scope

During the time period defined for the backlog review issues labeled with `security` and
`HackerOne` or `bug` will be reviewed.

For `gitlab-org/gitlab` project:
- [HackerOne](https://gitlab.com/gitlab-org/gitlab/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security&label_name[]=HackerOne)
- [bug](https://gitlab.com/gitlab-org/gitlab/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security&label_name[]=bug&not[label_name][]=HackerOne)

Other projects in scope:
- [Gitaly](https://gitlab.com/gitlab-org/gitaly/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security&label_name[]=HackerOne)
- [Pages](https://gitlab.com/gitlab-org/gitlab-pages/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security&label_name[]=HackerOne)
- [Workhorse](https://gitlab.com/gitlab-org/gitlab-workhorse/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security&not[label_name][]=HackerOne&label_name[]=bug)
- Runner
  - [HackerOne](https://gitlab.com/gitlab-org/gitlab-runner/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security&label_name[]=HackerOne)
  - [bug](https://gitlab.com/gitlab-org/gitlab-runner/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security&not[label_name][]=HackerOne&label_name[]=bug)
- [Shell](https://gitlab.com/gitlab-org/gitlab-shell/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=security&not[label_name][]=HackerOne&label_name[]=bug)
- [Customers](https://gitlab.com/gitlab-org/customers-gitlab-com/-/issues?scope=all&utf8=%E2%9C%93&state=opened&label_name[]=HackerOne)

### Issue Review Process

For each issue, it's categorization will need to be determined. The following are guidelines
the appsec engineer should follow to determine the appropriate category, and the steps that
should be taken.

#### Not Reviewed

The `~security-backlog::not-reviewed` label should be applied to issues that have not been reviewed to track them more easily.

#### Valid

An issue is `valid` if it is a vulnerability that continues to be present in the product.

- Apply the `~security-backlog::valid` label

#### Closed

An issue is `closed` if it is determined that the issue has previously been fixed,
is a known duplicate of another issue, or is not longer relevant due to evolution of the product.

- Apply the `~security-backlog::closed` label
- Leave a comment stating the determined reason and close the issue.
    - If duplicate: Use the `/duplicate <#issue>` slash command to close issue

#### Reclassified

An issue is `reclassified` if it can be considered a ~feature or a non-security ~bug, based on evolution of the product or our threat model. For example, reports that are no longer in-scope for bounty.

- Apply the `~security-backlog::reclassified` label
- Remove severity and priority if assigned by a Security Engineer
- Either:
  - Remove the ~bug label and apply the appropriate ~feature, ~feature::maintenance, or ~feature::addition, or ~documentation label.
  - Remove the ~security label.
- Leave a comment stating the determined reason for the reclassification.
- Review the issue for any confidential information and make it public if possible.

#### Needs Risk Acceptance

The general guidelines for issues eligible for risk acceptance are laid out below. There is no perfect formula, so
the judgement of the engineer will be relied upon.

- Long-lived, with little evidence of an upcoming fix
- Could it be made public with no impact?
  - Would it also labelled as ~"Accepting Merge Requests" 
- Could it be ~security::reclassified as `~feature::maintenance` by the product managers based on a use case? (e.g. Guest user can see a count of X but don't have access to view individual X)
- Is it S3/P3 or lower?

If an issue is eligible for risk acceptance:
- Add comment stating why the issue should be considered for risk acceptance
- Apply the `~security-backlog::risk-acceptance` label

#### Needs Input

An issue `needs input` if the appsec engineer cannot determine the appropriate category.

- Apply the `~security-backlog::needs-input` label

### Risk Acceptance Process

TBD
